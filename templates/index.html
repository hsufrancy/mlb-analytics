<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLB Analytics - Live Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>‚öæ MLB Analytics System</h1>
                <p class="subtitle">Lambda Architecture - Real-time & Batch Analytics</p>
            </div>
            <nav class="nav">
                <a href="/" class="nav-link active">Live Dashboard</a>
                <a href="/historical" class="nav-link">Historical Analytics</a>
            </nav>
        </header>

        <!-- Live Games Section -->
        <section class="section">
            <h2 class="section-title">üî¥ Live Games</h2>
            <div id="live-games-container">
                <p class="loading">Loading live games...</p>
            </div>
        </section>
    </div>

    <script>
        // Fetch live games
        async function fetchLiveGames() {
            try {
                const response = await fetch('/api/live-games');
                const games = await response.json();
                displayLiveGames(games);
            } catch (error) {
                console.error('Error fetching live games:', error);
                document.getElementById('live-games-container').innerHTML = 
                    '<p class="error">Error loading live games</p>';
            }
        }

        function displayLiveGames(games) {
            const container = document.getElementById('live-games-container');
            
            if (games.length === 0) {
                container.innerHTML = '<p class="no-data">No live games at the moment</p>';
                return;
            }

            container.innerHTML = games.map(game => `
                <div class="game-card">
                    <div class="live-badge">‚óè LIVE</div>
                    
                    <div class="game-content">
                        <div class="teams-scores">
                            <div class="team-row">
                                <span class="team-name">${game.away_team}</span>
                                <span class="score">${game.away_score}</span>
                            </div>
                            <div class="team-row">
                                <span class="team-name">${game.home_team}</span>
                                <span class="score">${game.home_score}</span>
                            </div>
                        </div>
                        
                        <div class="game-info">
                            <p class="inning">Inning: ${game.inning}</p>
                        </div>
                        
                        <div class="predictions">
                            <p class="prediction-title">Win Probability</p>
                            <div class="prob-bar">
                                <div class="prob-item">
                                    <span class="prob-label">${game.away_team}: ${Math.round(game.away_win_prob * 100)}%</span>
                                    <div class="prob-bar-bg">
                                        <div class="prob-bar-fill" style="width: ${game.away_win_prob * 100}%"></div>
                                    </div>
                                </div>
                                <div class="prob-item">
                                    <span class="prob-label">${game.home_team}: ${Math.round(game.home_win_prob * 100)}%</span>
                                    <div class="prob-bar-bg">
                                        <div class="prob-bar-fill" style="width: ${game.home_win_prob * 100}%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Auto-refresh every 10 seconds
        fetchLiveGames();
        setInterval(fetchLiveGames, 10000);
    </script>
</body>
</html>